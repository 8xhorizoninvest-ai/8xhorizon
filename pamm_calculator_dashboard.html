<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAMM Calculator ‚Äî 24-5 Gold Scalper</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ‚îÄ‚îÄ EXACT PROP FARM PRO THEME ‚îÄ‚îÄ */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-card: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --text-tertiary: #94a3b8;
            --border: #e2e8f0;
            --border-hover: #cbd5e1;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --purple: #8b5cf6;
            --orange: #f97316;
            --cyan: #06b6d4;
            --gold: #d97706;
            --gold-bg: rgba(217, 119, 6, 0.08);
            --shadow-sm: 0 1px 2px 0 rgba(0,0,0,0.05);
            --shadow: 0 1px 3px 0 rgba(0,0,0,0.1), 0 1px 2px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* TOP BAR */
        .top-bar {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 1.25rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 90;
        }
        .top-bar-left { display: flex; align-items: center; gap: 1rem; }
        .page-title { font-size: 1.5rem; font-weight: 700; }
        .logo-badge {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--gold);
            background: var(--gold-bg);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            border: 1px solid rgba(217,119,6,0.2);
        }

        /* CONTAINER */
        .container {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ALERT */
        .alert {
            padding: 1rem 1.25rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            font-size: 0.9375rem;
            font-weight: 500;
        }
        .alert-info {
            background: rgba(59,130,246,0.08);
            color: var(--accent);
            border: 1px solid rgba(59,130,246,0.2);
        }
        .alert-gold {
            background: var(--gold-bg);
            color: var(--gold);
            border: 1px solid rgba(217,119,6,0.25);
        }
        .alert-success {
            background: rgba(16,185,129,0.08);
            color: var(--success);
            border: 1px solid rgba(16,185,129,0.2);
        }
        .alert-danger {
            background: rgba(239,68,68,0.08);
            color: var(--danger);
            border: 1px solid rgba(239,68,68,0.2);
        }

        /* LIVE STATS STRIP */
        .live-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-pill {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            transition: all 0.2s;
        }
        .stat-pill:hover { border-color: var(--border-hover); box-shadow: var(--shadow); transform: translateY(-1px); }
        .stat-pill .sp-val {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        .stat-pill .sp-val.pos { color: var(--success); }
        .stat-pill .sp-val.neg { color: var(--danger); }
        .stat-pill .sp-val.gold { color: var(--gold); }
        .stat-pill .sp-val.blue { color: var(--accent); }
        .stat-pill .sp-val.purple { color: var(--purple); }
        .stat-pill .sp-lbl {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }

        /* SECTION TITLE */
        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: 800;
        }
        .section-badge {
            font-size: 0.75rem;
            font-weight: 700;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            background: rgba(59,130,246,0.1);
            color: var(--accent);
        }

        /* MAIN GRID */
        .main-grid {
            display: grid;
            grid-template-columns: 420px 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        @media (max-width: 1100px) { .main-grid { grid-template-columns: 1fr; } }

        /* CARDS */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }
        .card-header {
            padding: 1.25rem 1.75rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .card-title {
            font-size: 1rem;
            font-weight: 700;
        }
        .card-body { padding: 1.75rem; }
        .card-body.no-pad { padding: 0; }

        /* FORM ELEMENTS */
        .form-group { margin-bottom: 1.25rem; }
        .form-label {
            display: block;
            font-size: 0.8125rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }
        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--text-primary);
            background: var(--bg-secondary);
            transition: all 0.2s;
            -moz-appearance: textfield;
        }
        .form-input::-webkit-outer-spin-button,
        .form-input::-webkit-inner-spin-button { -webkit-appearance: none; }
        .form-input:focus {
            outline: none;
            border-color: var(--accent);
            background: var(--bg-primary);
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }
        .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 0.9375rem;
            font-family: inherit;
            color: var(--text-primary);
            background: var(--bg-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }
        .form-select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }

        /* RANGE SLIDER */
        .range-slider {
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            outline: none;
            margin-top: 0.6rem;
            padding: 0;
            border: none;
        }
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px; height: 18px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 1px 4px rgba(59,130,246,0.4);
            transition: transform 0.15s;
        }
        .range-slider::-webkit-slider-thumb:hover { transform: scale(1.2); }
        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: var(--text-tertiary);
            margin-top: 0.25rem;
            font-family: 'JetBrains Mono', monospace;
        }

        /* SCENARIO TABS */
        .scenario-tabs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            border: 2px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }
        .stab {
            padding: 0.625rem;
            background: var(--bg-secondary);
            border: none;
            font-size: 0.8rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.15s;
            border-right: 1px solid var(--border);
            text-transform: uppercase;
            letter-spacing: 0.04em;
            color: var(--text-secondary);
        }
        .stab:last-child { border-right: none; }
        .stab.active { background: var(--accent); color: white; }
        .stab:hover:not(.active) { background: var(--border); color: var(--text-primary); }

        /* INPUT WITH PREFIX */
        .input-with-prefix {
            display: flex;
            align-items: center;
            border: 2px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            background: var(--bg-secondary);
            transition: all 0.2s;
        }
        .input-with-prefix:focus-within {
            border-color: var(--accent);
            background: var(--bg-primary);
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }
        .input-prefix-label {
            padding: 0.75rem 0.875rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            background: var(--border);
            border-right: 2px solid var(--border);
            white-space: nowrap;
        }
        .input-with-prefix input {
            flex: 1;
            border: none;
            background: transparent;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--text-primary);
            outline: none;
            -moz-appearance: textfield;
        }
        .input-with-prefix input::-webkit-outer-spin-button,
        .input-with-prefix input::-webkit-inner-spin-button { -webkit-appearance: none; }

        /* RESULT HERO */
        .result-hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 14px;
            padding: 1.5rem;
            margin-bottom: 1.25rem;
            color: white;
            text-align: center;
        }
        .rh-label {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            opacity: 0.85;
            margin-bottom: 0.5rem;
        }
        .rh-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.75rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            line-height: 1;
            margin-bottom: 0.4rem;
        }
        .rh-sub { font-size: 0.85rem; opacity: 0.8; }

        /* RESULT GRID */
        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1px;
            background: var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 1.25rem;
            border: 1px solid var(--border);
        }
        .rg-cell {
            background: var(--bg-secondary);
            padding: 0.875rem 1.25rem;
        }
        .rg-val {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.05rem;
            font-weight: 700;
            margin-bottom: 0.2rem;
        }
        .rg-val.pos { color: var(--success); }
        .rg-val.neg { color: var(--danger); }
        .rg-val.gold { color: var(--gold); }
        .rg-val.blue { color: var(--accent); }
        .rg-val.purple { color: var(--purple); }
        .rg-lbl {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }

        /* PROGRESS BAR */
        .prog-wrap { margin-bottom: 1rem; }
        .prog-head {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 0.4rem;
        }
        .prog-track {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
        }
        .prog-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        .prog-fill.blue { background: linear-gradient(90deg, #667eea, #3b82f6); }
        .prog-fill.green { background: linear-gradient(90deg, #10b981, #34d399); }
        .prog-fill.gold { background: linear-gradient(90deg, #d97706, #f59e0b); }

        /* CHART */
        .chart-wrap {
            position: relative;
            height: 200px;
            margin-top: 1rem;
        }
        canvas { display: block; }

        /* REFERENCE NOTE */
        .ref-note {
            background: rgba(59,130,246,0.05);
            border: 1px solid rgba(59,130,246,0.15);
            border-left: 3px solid var(--accent);
            border-radius: 0 10px 10px 0;
            padding: 0.875rem 1.25rem;
            margin-top: 1rem;
            font-size: 0.8125rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }
        .ref-note strong { color: var(--accent); }
        .ref-note .ref-title {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--accent);
            margin-bottom: 0.4rem;
        }

        /* MONTHLY TABLE */
        .monthly-table { width: 100%; border-collapse: collapse; }
        .monthly-table th {
            text-align: left;
            padding: 0.875rem 1.25rem;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--border);
        }
        .monthly-table td {
            padding: 0.875rem 1.25rem;
            font-size: 0.875rem;
            font-family: 'JetBrains Mono', monospace;
            border-bottom: 1px solid var(--border);
            font-weight: 500;
        }
        .monthly-table tr:hover td { background: rgba(59,130,246,0.03); }
        .monthly-table .total-row td {
            background: rgba(59,130,246,0.06);
            border-top: 2px solid var(--accent);
            border-bottom: none;
            font-weight: 700;
        }
        .monthly-table td.pos { color: var(--success); }
        .monthly-table td.neg { color: var(--danger); }
        .monthly-table td.gold { color: var(--gold); }

        /* SCENARIO RISK CARDS */
        .scenario-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.25rem;
            margin-bottom: 1.5rem;
        }
        @media (max-width: 800px) { .scenario-cards { grid-template-columns: 1fr; } }

        .sc-card {
            background: var(--bg-card);
            border: 1.5px solid var(--border);
            border-radius: 14px;
            padding: 1.5rem;
            transition: all 0.2s;
        }
        .sc-card:hover { box-shadow: var(--shadow-lg); transform: translateY(-2px); }
        .sc-card.bear { border-color: rgba(239,68,68,0.3); background: rgba(239,68,68,0.02); }
        .sc-card.base { border-color: rgba(217,119,6,0.4); background: var(--gold-bg); }
        .sc-card.bull { border-color: rgba(16,185,129,0.3); background: rgba(16,185,129,0.02); }

        .sc-header {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            margin-bottom: 1rem;
        }
        .sc-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
        .sc-card.bear .sc-dot { background: var(--danger); }
        .sc-card.base .sc-dot { background: var(--gold); }
        .sc-card.bull .sc-dot { background: var(--success); }
        .sc-label {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }
        .sc-card.bear .sc-label { color: var(--danger); }
        .sc-card.base .sc-label { color: var(--gold); }
        .sc-card.bull .sc-label { color: var(--success); }

        .sc-return {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.25rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            margin-bottom: 0.25rem;
        }
        .sc-card.bear .sc-return { color: var(--danger); }
        .sc-card.base .sc-return { color: var(--gold); }
        .sc-card.bull .sc-return { color: var(--success); }
        .sc-final {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        .sc-detail {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        .sc-divider {
            height: 1px;
            background: var(--border);
            margin: 0.875rem 0;
        }
        .sc-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            font-size: 0.75rem;
        }
        .sc-stat { }
        .sc-stat-val { font-family: 'JetBrains Mono', monospace; font-weight: 700; color: var(--text-primary); }
        .sc-stat-lbl { color: var(--text-secondary); }

        /* TRANSACTIONS */
        .tx-table { width: 100%; border-collapse: collapse; }
        .tx-table th {
            text-align: left;
            padding: 0.75rem 1.25rem;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--border);
        }
        .tx-table td {
            padding: 0.75rem 1.25rem;
            font-size: 0.8375rem;
            border-bottom: 1px solid var(--border);
        }
        .tx-table tr:hover td { background: var(--bg-secondary); }
        .tx-sym {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            color: var(--gold);
            background: var(--gold-bg);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
        }
        .tx-profit {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            font-size: 0.9rem;
        }

        /* DISCLAIMER */
        .disclaimer {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 1.5rem;
        }
        .disclaimer-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
        }
        .disclaimer-icon {
            width: 40px; height: 40px;
            border-radius: 10px;
            background: rgba(245,158,11,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }
        .disclaimer h3 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        .disclaimer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-bottom: 1.25rem;
        }
        .dis-block {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem 1.25rem;
        }
        .dis-block h4 {
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        .dis-block.warn h4 { color: var(--warning); }
        .dis-block.info h4 { color: var(--accent); }
        .dis-block.safe h4 { color: var(--success); }
        .dis-block p {
            font-size: 0.8125rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }
        .disclaimer .fine-print {
            font-size: 0.775rem;
            color: var(--text-tertiary);
            line-height: 1.75;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        /* FULL WIDTH */
        .full { grid-column: 1 / -1; }

        /* METRIC INLINE */
        .inline-metrics {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            margin-bottom: 0.5rem;
        }
        .im { }
        .im-val { font-family: 'JetBrains Mono', monospace; font-size: 1rem; font-weight: 700; }
        .im-lbl { font-size: 0.7rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; }

        /* ANIMATE */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(12px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .card { animation: fadeUp 0.4s ease both; }

        /* XAUUSD REFERENCE TAG */
        .xau-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            background: var(--gold-bg);
            border: 1px solid rgba(217,119,6,0.25);
            color: var(--gold);
            font-size: 0.72rem;
            font-weight: 700;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
        }

        /* RETURNS REFERENCE TABLE */
        .ref-table { width: 100%; border-collapse: collapse; }
        .ref-table th {
            text-align: left;
            padding: 0.625rem 1rem;
            font-size: 0.68rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
        }
        .ref-table td {
            padding: 0.625rem 1rem;
            font-size: 0.8125rem;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            border-bottom: 1px solid var(--border);
        }
        .ref-table tr:hover td { background: var(--bg-secondary); }
        .ref-table tr.active-row td { background: rgba(59,130,246,0.06); }

        /* ‚ïê‚ïê‚ïê INVESTMENT TRACKER ‚ïê‚ïê‚ïê */
        .tracker-section { margin-top: 2rem; }
        .tracker-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
        @media (max-width: 900px) { .tracker-grid { grid-template-columns: 1fr; } }

        .tracker-form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        @media (max-width: 600px) { .tracker-form-grid { grid-template-columns: 1fr; } }

        .milestone-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(155px, 1fr)); gap: 0.75rem; margin-bottom: 1.5rem; }

        .milestone-card {
            background: var(--bg-card);
            border: 1.5px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.2s;
        }
        .milestone-card:hover { box-shadow: var(--shadow); transform: translateY(-1px); }
        .milestone-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; }
        .milestone-card.past::before { background: var(--text-tertiary); }
        .milestone-card.today::before { background: var(--accent); }
        .milestone-card.soon::before { background: var(--success); }
        .milestone-card.future::before { background: var(--border-hover); }

        .ms-period { font-size: 0.625rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.07em; color: var(--text-secondary); margin-bottom: 0.3rem; }
        .ms-date { font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; font-weight: 800; color: var(--text-primary); margin-bottom: 0.15rem; line-height: 1.2; }
        .ms-rel { font-size: 0.65rem; color: var(--text-secondary); margin-bottom: 0.4rem; }
        .ms-val { font-family: 'JetBrains Mono', monospace; font-size: 1.125rem; font-weight: 800; color: var(--success); }
        .ms-profit { font-size: 0.65rem; color: var(--text-secondary); margin-top: 0.15rem; }
        .ms-badge { display: inline-block; font-size: 0.5rem; font-weight: 700; padding: 0.1rem 0.4rem; border-radius: 4px; margin-top: 0.35rem; text-transform: uppercase; letter-spacing: 0.07em; }
        .ms-badge.past { background: rgba(100,116,139,0.1); color: var(--text-secondary); }
        .ms-badge.now { background: rgba(59,130,246,0.1); color: var(--accent); }
        .ms-badge.coming { background: rgba(16,185,129,0.1); color: var(--success); }

        /* COMPARE ROWS */
        .compare-block { display: flex; flex-direction: column; gap: 0.625rem; margin-bottom: 1.25rem; }
        .compare-row {
            display: flex; align-items: center; justify-content: space-between;
            padding: 0.75rem 1rem; border-radius: 10px; border: 1.5px solid;
            gap: 1rem; flex-wrap: wrap;
        }
        .compare-row.projected { border-color: rgba(59,130,246,0.25); background: rgba(59,130,246,0.04); }
        .compare-row.actual-pos { border-color: rgba(16,185,129,0.3); background: rgba(16,185,129,0.04); }
        .compare-row.actual-neg { border-color: rgba(239,68,68,0.3); background: rgba(239,68,68,0.04); }
        .compare-row.beat { border-color: rgba(16,185,129,0.4); background: rgba(16,185,129,0.07); }
        .compare-row.missed { border-color: rgba(239,68,68,0.4); background: rgba(239,68,68,0.07); }
        .cr-label { font-size: 0.8125rem; font-weight: 600; color: var(--text-secondary); }
        .cr-val { font-family: 'JetBrains Mono', monospace; font-size: 1.0625rem; font-weight: 800; white-space: nowrap; }

        /* TRADE LOG TABLE */
        .trade-log-table { width: 100%; border-collapse: collapse; min-width: 520px; }
        .trade-log-table th { text-align: left; padding: 0.625rem 1rem; font-size: 0.65rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em; color: var(--text-secondary); background: var(--bg-secondary); border-bottom: 2px solid var(--border); white-space: nowrap; }
        .trade-log-table td { padding: 0.625rem 1rem; font-size: 0.8125rem; border-bottom: 1px solid var(--border); vertical-align: middle; }
        .trade-log-table tr:hover td { background: rgba(59,130,246,0.03); }
        .trade-log-table input, .trade-log-table select { padding: 0.3rem 0.6rem; border: 1.5px solid var(--border); border-radius: 7px; font-size: 0.8rem; font-family: 'JetBrains Mono', monospace; font-weight: 600; color: var(--text-primary); background: var(--bg-secondary); outline: none; width: 100%; transition: border-color 0.15s; }
        .trade-log-table input:focus, .trade-log-table select:focus { border-color: var(--accent); background: var(--bg-primary); }
        .trade-log-table input[type="number"] { -moz-appearance: textfield; }
        .trade-log-table input[type="number"]::-webkit-outer-spin-button,
        .trade-log-table input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; }
        .del-btn { background: rgba(239,68,68,0.08); color: var(--danger); border: 1px solid rgba(239,68,68,0.25); border-radius: 7px; padding: 0.25rem 0.6rem; font-size: 0.7rem; font-weight: 700; cursor: pointer; white-space: nowrap; transition: all 0.15s; }
        .del-btn:hover { background: rgba(239,68,68,0.15); }
        .add-btn { display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.5rem 1rem; background: rgba(59,130,246,0.08); color: var(--accent); border: 1.5px solid rgba(59,130,246,0.25); border-radius: 9px; font-size: 0.8125rem; font-weight: 700; cursor: pointer; transition: all 0.2s; font-family: inherit; }
        .add-btn:hover { background: rgba(59,130,246,0.15); }
        .log-summary { display: flex; gap: 1.5rem; flex-wrap: wrap; padding: 0.875rem 1.25rem; background: var(--bg-secondary); border-top: 1px solid var(--border); font-size: 0.8125rem; }
        .log-sum-item { display: flex; flex-direction: column; gap: 0.1rem; }
        .log-sum-val { font-family: 'JetBrains Mono', monospace; font-weight: 800; font-size: 0.9375rem; }
        .log-sum-lbl { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--text-secondary); }

        /* STAT TILES */
        .stat-tiles { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 0.75rem; margin-bottom: 1.5rem; }
        .stat-tile { background: var(--bg-card); border: 1.5px solid var(--border); border-radius: 12px; padding: 0.875rem 1rem; text-align: center; }
        .st-val { font-family: 'JetBrains Mono', monospace; font-size: 1.25rem; font-weight: 800; margin-bottom: 0.2rem; }
        .st-lbl { font-size: 0.6rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em; color: var(--text-secondary); }
        .st-sub { font-size: 0.6rem; color: var(--text-tertiary); margin-top: 0.1rem; }
        .st-val.pos { color: var(--success); }
        .st-val.neg { color: var(--danger); }
        .st-val.gold { color: var(--gold); }
        .st-val.blue { color: var(--accent); }
        .st-val.purple { color: var(--purple); }

        /* SECTION DIVIDER */
        .sec-div { display: flex; align-items: center; gap: 1rem; margin: 2rem 0 1.25rem; }
        .sec-div h3 { font-size: 1.125rem; font-weight: 800; white-space: nowrap; }
        .sec-div-line { flex: 1; height: 1px; background: var(--border); }

        /* EMPTY STATE */
        .tracker-empty { text-align: center; padding: 3rem 2rem; color: var(--text-secondary); }
        .tracker-empty .em-icon { font-size: 2.5rem; margin-bottom: 0.75rem; }
        .tracker-empty .em-title { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 0.375rem; }

        /* ‚ïê‚ïê‚ïê MOBILE IMPROVEMENTS ‚ïê‚ïê‚ïê */
        @media (max-width: 768px) {
            .top-bar { padding: 0.875rem 1rem; flex-wrap: wrap; gap: 0.5rem; }
            .page-title { font-size: 1.125rem; }
            .container { padding: 1rem; }
            .main-grid { grid-template-columns: 1fr; }
            .live-stats { grid-template-columns: repeat(3, 1fr); }
            .scenario-cards { grid-template-columns: 1fr; }
            .result-grid { grid-template-columns: 1fr 1fr; }
            .rh-value { font-size: 2rem; }
            .milestone-grid { grid-template-columns: repeat(2, 1fr); }
            .stat-tiles { grid-template-columns: repeat(2, 1fr); }
            .log-summary { gap: 0.875rem; }
        }
        @media (max-width: 480px) {
            .live-stats { grid-template-columns: repeat(2, 1fr); }
            .tracker-form-grid { grid-template-columns: 1fr; }
            .milestone-grid { grid-template-columns: repeat(2, 1fr); }
            .stat-tiles { grid-template-columns: repeat(2, 1fr); }
            .compare-row { flex-direction: column; align-items: flex-start; gap: 0.25rem; }
            .top-bar > div:last-child { display: none; }
        }
    </style>
</head>
<body>

    <!-- TOP BAR -->
    <div class="top-bar">
        <div class="top-bar-left">
            <h1 class="page-title">PAMM Investment Calculator</h1>
        </div>
        <div style="display:flex;align-items:center;gap:0.75rem;">
            <span class="xau-tag">‚ö° XAUUSD</span>
            <span style="font-size:0.8rem;color:var(--text-secondary);font-family:'JetBrains Mono',monospace;">Performance Reference Data</span>
        </div>
    </div>

    <div class="container">

        <!-- PERFORMANCE REFERENCE STRIP -->
        <div class="alert alert-info" style="margin-bottom:1.5rem;font-size:0.85rem;">
            <strong>üìä Performance Reference:</strong> All return figures in this calculator are sourced from verified XAUUSD PAMM trading data ‚Äî 123 days, 297 trades, 71.7% win rate, $20,585 total profit. Use the stats below as your basis for rate assumptions.
        </div>

        <!-- LIVE STATS STRIP ‚Äî expanded with daily avg etc -->
        <div class="live-stats" style="margin-bottom:2rem;">
            <div class="stat-pill">
                <div class="sp-val gold">+370.81%</div>
                <div class="sp-lbl">Total Return</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val pos">+119.23%</div>
                <div class="sp-lbl">Monthly Return</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val pos">+332.29%</div>
                <div class="sp-lbl">Quarter Return</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val pos">+5.77%</div>
                <div class="sp-lbl">Weekly Return</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val gold">$167.36</div>
                <div class="sp-lbl">Daily Avg Profit</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val blue">$69.31</div>
                <div class="sp-lbl">Avg P&L / Trade</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val pos">71.7%</div>
                <div class="sp-lbl">Win Rate</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val purple">2.41√ó</div>
                <div class="sp-lbl">Win / Loss Ratio</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val blue">15.85</div>
                <div class="sp-lbl">Recovery Factor</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val purple">0.46</div>
                <div class="sp-lbl">Sharpe Ratio</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val pos">213 / 84</div>
                <div class="sp-lbl">Wins / Losses</div>
            </div>
            <div class="stat-pill">
                <div class="sp-val gold">2:36</div>
                <div class="sp-lbl">Avg Trade Duration</div>
            </div>
        </div>

        <!-- MAIN GRID: INPUT + RESULTS -->
        <div class="main-grid">

            <!-- LEFT: INPUTS -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">‚öôÔ∏è Investment Parameters</span>
                    <span class="xau-tag">XAUUSD</span>
                </div>
                <div class="card-body">

                    <div class="scenario-tabs">
                        <button class="stab active" onclick="setPreset('conservative')">Conservative</button>
                        <button class="stab" onclick="setPreset('base')">Base Case</button>
                        <button class="stab" onclick="setPreset('aggressive')">Aggressive</button>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Investment Amount (USD)</label>
                        <div class="input-with-prefix">
                            <span class="input-prefix-label">$</span>
                            <input type="number" id="investAmount" value="1000" min="100" max="100000" step="100" oninput="syncRanges(); calc()">
                        </div>
                        <input type="range" class="range-slider" id="investRange" min="100" max="50000" step="100" value="1000" oninput="syncFromRange('invest')">
                        <div class="range-labels"><span>$100</span><span>$10K</span><span>$25K</span><span>$50K</span></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Projection Period</label>
                        <div class="input-with-prefix">
                            <span class="input-prefix-label">MO</span>
                            <input type="number" id="months" value="6" min="1" max="24" oninput="syncRanges(); calc()">
                        </div>
                        <input type="range" class="range-slider" id="monthsRange" min="1" max="24" value="6" oninput="syncFromRange('months')">
                        <div class="range-labels"><span>1</span><span>6</span><span>12</span><span>24</span></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Monthly Return Rate ‚Äî <span style="color:var(--gold);font-weight:700;">Reference avg: 119.23%/mo</span></label>
                        <div class="input-with-prefix">
                            <span class="input-prefix-label">%</span>
                            <input type="number" id="monthlyRate" value="119.23" step="0.1" oninput="syncRanges(); calc()">
                        </div>
                        <input type="range" class="range-slider" id="rateRange" min="1" max="300" step="0.1" value="119.23" oninput="syncFromRange('rate')">
                        <div class="range-labels"><span>1%</span><span>75%</span><span>150%</span><span>300%</span></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Performance Fee (%)</label>
                        <div class="input-with-prefix">
                            <span class="input-prefix-label">%</span>
                            <input type="number" id="perfFee" value="30" min="0" max="50" oninput="calc()">
                        </div>
                        <div class="ref-note" style="margin-top:0.5rem;font-size:0.75rem;">
                            <strong>Note:</strong> Fee applied on profitable months only. No fee charged on flat or losing periods.
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Profit Strategy</label>
                        <select class="form-select" id="compound" onchange="calc()">
                            <option value="yes">Full Compounding ‚Äî reinvest 100% of profit</option>
                            <option value="no">Full Withdrawal ‚Äî withdraw all profits monthly</option>
                            <option value="half">Split 50/50 ‚Äî reinvest half, withdraw half</option>
                        </select>
                    </div>

                    <!-- PERFORMANCE REFERENCE TABLE -->
                    <div style="border:1px solid var(--border);border-radius:10px;overflow:hidden;margin-top:0.5rem;">
                        <div style="padding:0.75rem 1rem;background:var(--bg-secondary);border-bottom:1px solid var(--border);font-size:0.75rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-secondary);display:flex;align-items:center;gap:0.5rem;">
                            <span class="xau-tag">XAUUSD</span> Performance Reference
                        </div>
                        <table class="ref-table">
                            <thead>
                                <tr><th>Period</th><th>Return</th><th>Annualized Est.</th><th>Used In</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>1 Day (avg)</td><td class="gold">+3.01%</td><td class="pos">+1,100%+</td><td style="font-size:0.72rem;color:var(--text-secondary);">Daily calc</td></tr>
                                <tr><td>1 Week</td><td class="pos">+5.77%</td><td class="pos">+300%+</td><td style="font-size:0.72rem;color:var(--text-secondary);">Weekly ref</td></tr>
                                <tr class="active-row"><td>1 Month ‚≠ê Base</td><td class="gold">+119.23%</td><td class="gold">+1,431%</td><td style="font-size:0.72rem;color:var(--accent);font-weight:700;">Default rate</td></tr>
                                <tr><td>1 Quarter</td><td class="pos">+332.29%</td><td class="pos">+1,329%</td><td style="font-size:0.72rem;color:var(--text-secondary);">Quarterly</td></tr>
                                <tr><td>All Time (123d)</td><td class="gold">+370.81%</td><td class="pos">+1,100%+</td><td style="font-size:0.72rem;color:var(--text-secondary);">Total ref</td></tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>

            <!-- RIGHT: RESULTS -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìà Projected Returns</span>
                    <span id="compoundLabel" style="font-size:0.78rem;color:var(--text-secondary);font-weight:600;">Full Compounding</span>
                </div>
                <div class="card-body">

                    <div class="result-hero">
                        <div class="rh-label">Projected Final Value</div>
                        <div class="rh-value" id="finalValue">$0</div>
                        <div class="rh-sub" id="finalSub">After 30% performance fee ‚Ä¢ 6 months</div>
                    </div>

                    <div class="result-grid">
                        <div class="rg-cell">
                            <div class="rg-val pos" id="grossProfit">$0</div>
                            <div class="rg-lbl">Gross Profit</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val gold" id="netProfit">$0</div>
                            <div class="rg-lbl">Net Profit (after fee)</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val neg" id="feePaid">$0</div>
                            <div class="rg-lbl">Total Fee Paid</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val blue" id="roi">0%</div>
                            <div class="rg-lbl">Net ROI</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val purple" id="monthlyIncome">$0</div>
                            <div class="rg-lbl">Avg Monthly Net</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val" id="dailyIncome">$0</div>
                            <div class="rg-lbl">Avg Daily Profit</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val" id="weeklyIncome">$0</div>
                            <div class="rg-lbl">Avg Weekly Profit</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val" id="breakEven">~0 days</div>
                            <div class="rg-lbl">Break-Even Point</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val pos" id="projWinTrades">0</div>
                            <div class="rg-lbl">Est. Winning Trades</div>
                        </div>
                        <div class="rg-cell">
                            <div class="rg-val neg" id="projLossTrades">0</div>
                            <div class="rg-lbl">Est. Losing Trades</div>
                        </div>
                    </div>

                    <!-- PROGRESS BARS -->
                    <div class="prog-wrap">
                        <div class="prog-head">
                            <span style="color:var(--text-secondary);font-size:0.78rem;">Progress to 2√ó initial</span>
                            <span id="d2pct" style="font-family:'JetBrains Mono',monospace;font-weight:700;font-size:0.78rem;">0%</span>
                        </div>
                        <div class="prog-track"><div class="prog-fill blue" id="d2bar" style="width:0%"></div></div>
                    </div>
                    <div class="prog-wrap">
                        <div class="prog-head">
                            <span style="color:var(--text-secondary);font-size:0.78rem;">Progress to 5√ó initial</span>
                            <span id="d5pct" style="font-family:'JetBrains Mono',monospace;font-weight:700;font-size:0.78rem;">0%</span>
                        </div>
                        <div class="prog-track"><div class="prog-fill green" id="d5bar" style="width:0%"></div></div>
                    </div>
                    <div class="prog-wrap">
                        <div class="prog-head">
                            <span style="color:var(--text-secondary);font-size:0.78rem;">Progress to 10√ó initial</span>
                            <span id="d10pct" style="font-family:'JetBrains Mono',monospace;font-weight:700;font-size:0.78rem;">0%</span>
                        </div>
                        <div class="prog-track"><div class="prog-fill gold" id="d10bar" style="width:0%"></div></div>
                    </div>

                    <!-- CHART -->
                    <div class="chart-wrap">
                        <canvas id="projChart"></canvas>
                    </div>

                    <!-- CALCULATION REFERENCE NOTE -->
                    <div class="ref-note" id="calcNote">
                        <div class="ref-title">üìä Calculation Reference ‚Äî How We Got These Numbers</div>
                        <span id="calcNoteText">Enter parameters above to see full calculation breakdown.</span>
                    </div>

                </div>
            </div>

        </div><!-- end main-grid -->

        <!-- MONTH-BY-MONTH BREAKDOWN -->
        <div class="card" style="margin-bottom:1.5rem;">
            <div class="card-header">
                <span class="card-title">üóìÔ∏è Month-by-Month Breakdown</span>
                <span style="font-size:0.78rem;color:var(--text-secondary);" id="tableSubtitle">Based on 119.23%/mo reference avg</span>
            </div>
            <div class="card-body no-pad">
                <div style="overflow-x:auto;">
                    <table class="monthly-table">
                        <thead>
                            <tr>
                                <th>Month</th>
                                <th>Start Balance</th>
                                <th>Monthly Rate</th>
                                <th>Gross Profit</th>
                                <th>Perf. Fee</th>
                                <th>Net Profit</th>
                                <th>Withdrawal</th>
                                <th>End Balance</th>
                                <th>Daily Avg</th>
                                <th>Cumulative ROI</th>
                            </tr>
                        </thead>
                        <tbody id="monthlyBody"></tbody>
                    </table>
                </div>
                <div class="ref-note" style="margin:1.25rem;border-radius:10px;">
                    <div class="ref-title">üìä How These Numbers Are Calculated</div>
                    <span id="tableNote">Each month: Gross Profit = Start Balance √ó Monthly Rate. Performance fee deducted from profit only. Net Profit = Gross ‚àí Fee. Daily Avg = Net Profit √∑ 22 trading days. End Balance adjusts based on your compounding selection.</span>
                </div>
            </div>
        </div>

        <!-- RISK SCENARIOS -->
        <div class="section-header">
            <h2 class="section-title">üìâ Projection Scenarios</h2>
            <span class="section-badge">Referenced from performance data</span>
        </div>
        <div class="scenario-cards" id="scenarioCards"></div>
        <div class="ref-note" style="margin-bottom:1.5rem;">
            <div class="ref-title">üìä How Scenarios Are Derived ‚Äî Full Reference</div>
            <span id="scenarioNote">Loading scenario reference...</span>
        </div>

        <!-- DISCLAIMER -->
        <div class="disclaimer">
            <div class="disclaimer-header">
                <div class="disclaimer-icon">‚ö†Ô∏è</div>
                <div>
                    <h3>Calculator Projection Disclaimer</h3>
                    <div style="font-size:0.8rem;color:var(--text-secondary);margin-top:0.2rem;">Understanding what these projections mean ‚Äî and what they don't</div>
                </div>
            </div>

            <div class="disclaimer-grid">
                <div class="dis-block warn">
                    <h4>‚ö†Ô∏è These Are Projections, Not Predictions</h4>
                    <p>Every number this calculator produces is a <strong>mathematical model</strong> ‚Äî it applies a fixed monthly rate to your investment across time. Real PAMM accounts do not produce the exact same return every month. Some months will be higher, some lower, and some may be negative. The calculator cannot account for market volatility, drawdown periods, or strategy changes.</p>
                </div>
                <div class="dis-block info">
                    <h4>üìê How the Calculator Works</h4>
                    <p>Formula: <strong>Monthly Profit = Balance √ó Rate%</strong>. Fee deducted from profit only. Compounding option adds net profit back to balance each month ‚Äî this causes exponential growth in projections. Daily avg is estimated using 22 trading days/month. Weekly avg = Monthly √∑ 4.33. Break-even = initial investment √∑ avg monthly net √ó 30 days.</p>
                </div>
                <div class="dis-block safe">
                    <h4>‚úÖ Where the Reference Data Comes From</h4>
                    <p>The default 119.23% monthly rate is taken from the XAUUSD PAMM's most recent full month of verified trading: 297 total trades, 213 wins, 84 losses, $20,585 profit over 123 days. Daily avg of $167.36/day. Win/loss ratio: 2.41√ó. This is the factual basis for the Base Case scenario in this calculator.</p>
                </div>
                <div class="dis-block warn">
                    <h4>üìâ Scenario Range Explained</h4>
                    <p><strong>Conservative (40%/mo):</strong> ‚Öì of the recorded monthly avg ‚Äî models a slow or drawdown period. <strong>Base (119.23%/mo):</strong> The exact verified monthly return ‚Äî reflects current real performance. <strong>Aggressive (137%/mo):</strong> 15% above base ‚Äî models a stronger-than-average month, not an outlier. Each scenario uses the same fee structure and compounding logic.</p>
                </div>
                <div class="dis-block info">
                    <h4>üí∏ Fee Structure & Withdrawals</h4>
                    <p>The 30% performance fee default reflects a typical PAMM fee structure. Fee is applied to <strong>profits only</strong> ‚Äî never to your principal or during losing months. Under PAMM, you control your own capital. Withdrawals are typically processed on a set schedule by the broker. The fund manager does not have access to withdraw your principal.</p>
                </div>
                <div class="dis-block safe">
                    <h4>üìÖ How Long to Evaluate</h4>
                    <p>A single month's projection can look extraordinary at 119%+ rates. We recommend using the <strong>3-month or 6-month</strong> view to see realistic compounding in context. Any PAMM strategy should be evaluated over a minimum of 30‚Äì90 days before drawing conclusions. The conservative scenario is the most reasonable baseline for planning.</p>
                </div>
            </div>

            <div class="fine-print">
                <strong>Important:</strong> This calculator is a personal modelling tool only ‚Äî not financial advice, and not a guarantee of any returns. All reference figures (119.23% monthly, 370.81% total, 71.7% win rate, $20,585 profit) are historical data points used as inputs. Past performance does not guarantee future results. Trading involves risk of loss, including loss of principal. Projections are mathematical scenarios only and should be used for planning purposes, not as a basis for financial decisions. Always consult a qualified financial advisor before investing.
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- INVESTMENT TRACKER ‚Äî Compare Projected vs Actual   -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="tracker-section">

          <div class="sec-div">
            <h3>üí∞ Investment Tracker &amp; Return Calculator</h3>
            <div class="sec-div-line"></div>
          </div>

          <!-- TWO-COLUMN INPUT + LIVE BREAKDOWN -->
          <div class="tracker-grid" style="margin-bottom:1.5rem;">

            <!-- LEFT: INPUTS ‚Äî only what you know -->
            <div class="card">
              <div class="card-header">
                <span class="card-title">‚öôÔ∏è Your Trade Details</span>
                <span id="trPeriodBadge" style="font-size:0.72rem;color:var(--text-secondary);font-family:'JetBrains Mono',monospace;"></span>
              </div>
              <div class="card-body" style="display:flex;flex-direction:column;gap:1.125rem;">

                <!-- Amount invested -->
                <div class="form-group" style="margin:0">
                  <label class="form-label">üíµ How much did you invest?</label>
                  <div class="input-with-prefix">
                    <span class="input-prefix-label">$</span>
                    <input type="number" id="trInvest" value="1000" min="1" step="100" oninput="runTracker()">
                  </div>
                </div>

                <!-- Dates -->
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.875rem;">
                  <div class="form-group" style="margin:0">
                    <label class="form-label">üìÖ Start Date</label>
                    <input type="date" id="trFrom" class="form-input" style="padding:0.65rem 1rem;font-family:'JetBrains Mono',monospace;font-weight:600;" oninput="runTracker()">
                  </div>
                  <div class="form-group" style="margin:0">
                    <label class="form-label">üìÖ End Date</label>
                    <input type="date" id="trTo" class="form-input" style="padding:0.65rem 1rem;font-family:'JetBrains Mono',monospace;font-weight:600;" oninput="runTracker()">
                  </div>
                </div>

                <!-- Period summary auto-display -->
                <div id="trPeriodSummary" style="display:none;background:rgba(59,130,246,0.05);border:1px solid rgba(59,130,246,0.15);border-radius:10px;padding:0.75rem 1rem;font-size:0.8125rem;color:var(--text-secondary);"></div>

                <!-- Fee -->
                <div class="form-group" style="margin:0">
                  <label class="form-label">üí∏ Performance Fee (%)</label>
                  <div class="input-with-prefix">
                    <span class="input-prefix-label">%</span>
                    <input type="number" id="trFee" value="30" min="0" max="100" step="1" oninput="runTracker()">
                  </div>
                  <div style="font-size:0.65rem;color:var(--text-tertiary);margin-top:0.3rem;">Only deducted from profits. 0% if no fee applies.</div>
                </div>

                <!-- ACTUAL EARNED ‚Äî the key input, prominent -->
                <div style="background:rgba(16,185,129,0.05);border:2px solid rgba(16,185,129,0.3);border-radius:12px;padding:1.125rem;">
                  <label class="form-label" style="color:var(--success);margin-bottom:0.5rem;">‚úÖ What did you actually receive? ($)</label>
                  <div class="input-with-prefix" style="border-color:rgba(16,185,129,0.35);background:var(--bg-primary);">
                    <span class="input-prefix-label" style="background:rgba(16,185,129,0.12);color:var(--success);border-right-color:rgba(16,185,129,0.25);">$</span>
                    <input type="number" id="trActual" placeholder="Enter total amount you got back..." oninput="runTracker()" style="font-size:1.25rem;font-weight:700;">
                  </div>
                  <div style="font-size:0.7rem;color:var(--text-secondary);margin-top:0.5rem;">
                    Enter the <strong>total value</strong> you ended with (e.g. $1,850). The calculator works out your profit, return %, monthly rate, and compares it to the PAMM projection ‚Äî automatically.
                  </div>
                </div>

              </div>
            </div>

            <!-- RIGHT: LIVE RETURN BREAKDOWN -->
            <div class="card">
              <div class="card-header">
                <span class="card-title">üìä Your Return Breakdown</span>
                <span id="trVerdictBadge" style="font-size:0.72rem;font-weight:700;padding:0.2rem 0.75rem;border-radius:20px;display:none;border:1px solid;"></span>
              </div>
              <div id="trActualBreakdown">
                <div style="text-align:center;padding:3rem 1.5rem;color:var(--text-tertiary);">
                  <div style="font-size:2.5rem;margin-bottom:0.75rem;">üìä</div>
                  <div style="font-weight:700;color:var(--text-secondary);font-size:0.9375rem;margin-bottom:0.375rem;">Waiting for your numbers</div>
                  <div style="font-size:0.8rem;line-height:1.6;">Fill in your investment amount, start &amp; end dates, and what you actually received ‚Äî your full return breakdown will calculate instantly.</div>
                </div>
              </div>
            </div>

          </div>

          <!-- PROJECTION MILESTONES -->
          <div id="trackerResults" style="display:none">

            <div class="sec-div" style="margin-top:0.5rem;">
              <h3 style="font-size:0.9375rem;">üìÖ PAMM Projection Milestones ‚Äî Exact Dates from Your Start</h3>
              <div class="sec-div-line"></div>
            </div>
            <div style="font-size:0.8rem;color:var(--text-secondary);margin-bottom:1rem;">Based on the <strong style="color:var(--gold);">119.23%/mo PAMM reference rate</strong> ‚Äî showing what the projection says you <em>should</em> have at each date.</div>
            <div class="milestone-grid" id="trMilestones"></div>

            <!-- FULL TABLE + TRADE LOG -->
            <div class="tracker-grid">
              <div class="card">
                <div class="card-header"><span class="card-title">üìä Projected vs Actual ‚Äî Full Breakdown</span></div>
                <div class="card-body" id="trCompareBody">
                  <div style="font-size:0.8125rem;color:var(--text-secondary);font-style:italic;">Enter your actual received amount above to see the full comparison.</div>
                </div>
              </div>

              <div class="card">
                <div class="card-header" style="flex-wrap:wrap;gap:0.5rem">
                  <span class="card-title">üìã Trade Log</span>
                  <button class="add-btn" onclick="addTrade()">+ Add Trade</button>
                </div>
                <div style="overflow-x:auto">
                  <table class="trade-log-table">
                    <thead>
                      <tr><th>Date</th><th>Result</th><th>Gross ($)</th><th>Fee ($)</th><th>Net ($)</th><th>Note</th><th></th></tr>
                    </thead>
                    <tbody id="tradeBody">
                      <tr id="trNoTrades"><td colspan="7" style="text-align:center;color:var(--text-tertiary);font-size:0.75rem;padding:1.5rem 1rem">No trades logged yet. Click "+ Add Trade".</td></tr>
                    </tbody>
                  </table>
                </div>
                <div class="log-summary" id="trLogSummary" style="display:none"></div>
              </div>
            </div>

          </div>

        </div><!-- end tracker-section -->

    </div><!-- end container -->

<script>
const PAMM = {
    totalReturn: 370.81,
    monthReturn: 119.23,
    quarterReturn: 332.29,
    weekReturn: 5.77,
    dayReturn: 3.01,
    winRate: 71.7,
    avgWin: 127.06,
    avgLoss: 77.12,
    bestTrade: 3890,
    worstTrade: -650,
    totalProfit: 20585.35,
    tradesWon: 213,
    tradesLost: 84,
    totalTrades: 297,
    ageDays: 123,
    avgPnlPerTrade: 69.31,
    avgPnlPerLot: 115.49,
    dailyAvgProfit: 167.36,
    tradingDaysPerMonth: 22,
    recoveryFactor: 15.85,
    sharpe: 0.46,
    defaultFee: 30
};

// Aggressive = 15% above base
const PRESETS = {
    conservative: { rate: 40 },
    base:         { rate: 119.23 },
    aggressive:   { rate: +(119.23 * 1.15).toFixed(2) }
};

function setPreset(name) {
    document.querySelectorAll('.stab').forEach((b, i) => {
        b.classList.toggle('active', ['conservative','base','aggressive'][i] === name);
    });
    document.getElementById('monthlyRate').value = PRESETS[name].rate;
    document.getElementById('rateRange').value = PRESETS[name].rate;
    calc();
}

function syncFromRange(type) {
    if (type === 'invest') {
        document.getElementById('investAmount').value = document.getElementById('investRange').value;
    } else if (type === 'months') {
        document.getElementById('months').value = document.getElementById('monthsRange').value;
    } else if (type === 'rate') {
        document.getElementById('monthlyRate').value = parseFloat(document.getElementById('rateRange').value).toFixed(2);
    }
    calc();
}

function syncRanges() {
    document.getElementById('investRange').value = Math.min(parseFloat(document.getElementById('investAmount').value) || 1000, 50000);
    document.getElementById('monthsRange').value = document.getElementById('months').value;
    document.getElementById('rateRange').value = document.getElementById('monthlyRate').value;
}

function fmt(n, dec=0) {
    const abs = Math.abs(n);
    const s = new Intl.NumberFormat('en-US', {
        style:'currency', currency:'USD',
        minimumFractionDigits: dec,
        maximumFractionDigits: dec
    }).format(abs);
    return n < 0 ? '(' + s + ')' : s;
}

function fmtPct(n) {
    return (n >= 0 ? '+' : '') + n.toFixed(2) + '%';
}

function calc() {
    const invest   = parseFloat(document.getElementById('investAmount').value) || 1000;
    const months   = parseInt(document.getElementById('months').value) || 6;
    const rate     = parseFloat(document.getElementById('monthlyRate').value) || 119.23;
    const fee      = parseFloat(document.getElementById('perfFee').value) || 30;
    const compound = document.getElementById('compound').value;

    const compLabels = { yes: 'Full Compounding', no: 'Full Withdrawal', half: '50/50 Split' };
    document.getElementById('compoundLabel').textContent = compLabels[compound];

    const rows = [];
    let balance = invest;
    let totalGross=0, totalFee=0, totalNet=0, totalWithdrawn=0;

    for (let m = 1; m <= months; m++) {
        const start  = balance;
        const gross  = start * (rate / 100);
        const feeAmt = gross > 0 ? gross * (fee / 100) : 0;
        const net    = gross - feeAmt;
        const dailyAvg = net / PAMM.tradingDaysPerMonth;

        let reinvest = 0, withdrawn = 0;
        if (compound === 'yes')        { reinvest = net; withdrawn = 0; }
        else if (compound === 'no')    { reinvest = 0;   withdrawn = net; }
        else                           { reinvest = net * 0.5; withdrawn = net * 0.5; }

        balance = start + reinvest;
        totalGross    += gross;
        totalFee      += feeAmt;
        totalNet      += net;
        totalWithdrawn += withdrawn;

        const cumROI = ((balance + totalWithdrawn - invest) / invest) * 100;
        rows.push({ m, start, rate, gross, feeAmt, net, dailyAvg, reinvest, withdrawn, balance, cumROI });
    }

    const finalPortfolio = rows[rows.length-1]?.balance || invest;
    const totalValue  = finalPortfolio + totalWithdrawn;
    const roi         = ((totalValue - invest) / invest) * 100;
    const avgMonthly  = totalNet / months;
    const avgDaily    = avgMonthly / PAMM.tradingDaysPerMonth;
    const avgWeekly   = avgMonthly / 4.33;
    const breakEven   = avgMonthly > 0 ? Math.ceil((invest / avgMonthly) * 30) : 0;
    const totalTradingDays = months * PAMM.tradingDaysPerMonth;
    const tradesPerDay = PAMM.totalTrades / PAMM.ageDays;
    const projTotalTrades = Math.round(tradesPerDay * totalTradingDays);
    const projWins = Math.round(projTotalTrades * (PAMM.winRate / 100));
    const projLosses = projTotalTrades - projWins;

    // Update results
    document.getElementById('finalValue').textContent = fmt(totalValue);
    document.getElementById('finalSub').textContent =
        `After ${fee}% perf. fee ‚Ä¢ ${months} month${months!==1?'s':''} ‚Ä¢ ${compLabels[compound]}`;

    document.getElementById('grossProfit').textContent  = fmt(totalGross);
    document.getElementById('netProfit').textContent    = fmt(totalNet);
    document.getElementById('feePaid').textContent      = fmt(totalFee);
    document.getElementById('roi').textContent          = fmtPct(roi);
    document.getElementById('roi').className            = 'rg-val ' + (roi > 0 ? 'blue' : 'neg');
    document.getElementById('monthlyIncome').textContent = fmt(avgMonthly);
    document.getElementById('dailyIncome').textContent  = fmt(avgDaily, 2);
    document.getElementById('weeklyIncome').textContent = fmt(avgWeekly, 2);
    document.getElementById('breakEven').textContent    = breakEven > 0 ? `~${breakEven} days` : 'Immediate';
    document.getElementById('projWinTrades').textContent = projWins.toLocaleString();
    document.getElementById('projLossTrades').textContent = projLosses.toLocaleString();

    // Progress bars
    const p2  = Math.min((totalValue / (invest*2))  * 100, 100);
    const p5  = Math.min((totalValue / (invest*5))  * 100, 100);
    const p10 = Math.min((totalValue / (invest*10)) * 100, 100);
    document.getElementById('d2pct').textContent  = p2.toFixed(0)+'%';
    document.getElementById('d5pct').textContent  = p5.toFixed(0)+'%';
    document.getElementById('d10pct').textContent = p10.toFixed(0)+'%';
    document.getElementById('d2bar').style.width  = p2+'%';
    document.getElementById('d5bar').style.width  = p5+'%';
    document.getElementById('d10bar').style.width = p10+'%';

    // Calc reference note
    const m1gross = fmt(invest * rate / 100);
    const m1fee   = fmt(invest * rate / 100 * fee / 100);
    const m1net   = fmt(invest * rate / 100 * (1 - fee/100));
    const m1daily = fmt(invest * rate / 100 * (1 - fee/100) / PAMM.tradingDaysPerMonth, 2);
    const compNote = compound === 'yes'
        ? `With <strong>full compounding</strong>, each month's net profit is added to the balance ‚Äî meaning the next month earns returns on a larger base. This creates exponential growth: Month 1 earns on ${fmt(invest)}, Month 2 earns on more, and so on.`
        : compound === 'no'
        ? `With <strong>full withdrawal</strong>, net profit is taken out each month ‚Äî balance stays at ${fmt(invest)} throughout. Growth is linear: every month earns the same dollar amount.`
        : `With <strong>50/50 split</strong>, half of net profit is reinvested and half withdrawn. Moderate compounding effect ‚Äî balance grows slowly while generating monthly income.`;
    const rateNote = rate === PAMM.monthReturn
        ? `You're using the <strong>exact verified monthly average of ${PAMM.monthReturn}%</strong> from the XAUUSD performance data.`
        : rate < PAMM.monthReturn
        ? `You're using <strong>${rate}%</strong> ‚Äî below the verified ${PAMM.monthReturn}% avg. This is a more conservative assumption.`
        : `You're using <strong>${rate}%</strong> ‚Äî above the verified ${PAMM.monthReturn}% avg. This assumes stronger-than-average performance.`;

    document.getElementById('calcNoteText').innerHTML =
        `<strong>Month 1 step-by-step:</strong> ${fmt(invest)} √ó ${rate}% = ${m1gross} gross profit.
        ${fee}% fee on profit: ${m1fee}. Net profit = ${m1net}. Estimated daily avg = ${m1daily}/day (√∑22 trading days).
        <br><br><strong>Compounding logic:</strong> ${compNote}
        <br><br><strong>Rate basis:</strong> ${rateNote}
        <br><br><strong>Trade estimates:</strong> Based on ${(tradesPerDay).toFixed(1)} trades/day historical pace ‚Äî over ${months} month${months!==1?'s':''} (~${totalTradingDays} trading days), projecting ~${projTotalTrades} total trades, ~${projWins} wins at 71.7% win rate.`;

    // Table subtitle
    document.getElementById('tableSubtitle').textContent =
        `${rate}%/mo ‚Ä¢ Reference avg: ${PAMM.monthReturn}%/mo ‚Ä¢ ${compLabels[compound]}`;

    // Monthly table
    const tbody = document.getElementById('monthlyBody');
    tbody.innerHTML = '';
    rows.forEach(r => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td style="font-weight:700;color:var(--text-primary);">Month ${r.m}</td>
            <td>${fmt(r.start)}</td>
            <td class="${r.rate>0?'pos':'neg'}">${r.rate.toFixed(2)}%</td>
            <td class="pos">${fmt(r.gross)}</td>
            <td class="neg">(${fmt(r.feeAmt)})</td>
            <td class="${r.net>0?'pos':'neg'}">${fmt(r.net)}</td>
            <td style="color:var(--purple);font-weight:700;">${r.withdrawn>0?fmt(r.withdrawn):'‚Äî'}</td>
            <td class="gold">${fmt(r.balance)}</td>
            <td style="color:var(--accent);font-family:'JetBrains Mono',monospace;">${fmt(r.dailyAvg, 2)}</td>
            <td class="${r.cumROI>0?'pos':'neg'}">${fmtPct(r.cumROI)}</td>
        `;
        tbody.appendChild(tr);
    });

    // Total row
    const tRow = document.createElement('tr');
    tRow.className = 'total-row';
    tRow.innerHTML = `
        <td>TOTAL</td>
        <td>${fmt(invest)}</td>
        <td>‚Äî</td>
        <td class="pos">${fmt(totalGross)}</td>
        <td class="neg">(${fmt(totalFee)})</td>
        <td class="gold">${fmt(totalNet)}</td>
        <td style="color:var(--purple);">${totalWithdrawn>0?fmt(totalWithdrawn):'‚Äî'}</td>
        <td class="gold">${fmt(totalValue)}</td>
        <td style="color:var(--accent);">${fmt(avgDaily, 2)}</td>
        <td class="${roi>0?'pos':'neg'}">${fmtPct(roi)}</td>
    `;
    tbody.appendChild(tRow);

    // Table note
    document.getElementById('tableNote').innerHTML =
        `Formula: <strong>Gross = Balance √ó ${rate}%</strong>. Fee = Gross √ó ${fee}% (profit only).
        Net = Gross ‚àí Fee. Daily Avg = Net √∑ 22 trading days/month.
        Reference: XAUUSD avg ${PAMM.monthReturn}%/mo, daily avg $${PAMM.dailyAvgProfit}/day at historical pace.
        ${compound==='yes' ? 'Compounding: end balance grows each month, increasing future gross profits.' :
          compound==='no'  ? 'No compounding: balance stays fixed at initial investment each month.' :
                             '50/50: half of profit compounded, half withdrawn each month.'}`;

    drawChart(rows, invest, totalWithdrawn);
    drawScenarios(invest, months, fee);
}

function drawChart(rows, invest, totalWithdrawn) {
    const canvas = document.getElementById('projChart');
    const parent = canvas.parentElement;
    canvas.width  = parent.offsetWidth || 600;
    canvas.height = parent.offsetHeight || 200;
    const ctx = canvas.getContext('2d');
    const W = canvas.width, H = canvas.height;

    const labels = ['Start', ...rows.map(r => 'M'+r.m)];
    let cumWithdrawn = 0;
    const values = [invest, ...rows.map(r => { cumWithdrawn += r.withdrawn; return r.balance + cumWithdrawn; })];
    const maxV = Math.max(...values) * 1.05;
    const minV = Math.min(...values) * 0.95;
    const range = maxV - minV || 1;

    const pad = { top:16, right:16, bottom:28, left:68 };
    const cW = W-pad.left-pad.right, cH = H-pad.top-pad.bottom;
    ctx.clearRect(0, 0, W, H);

    const pts = values.map((v,i) => ({
        x: pad.left + (cW/(labels.length-1))*i,
        y: pad.top + cH - ((v-minV)/range)*cH
    }));

    ctx.strokeStyle='#e2e8f0'; ctx.lineWidth=1;
    for (let i=0; i<=4; i++) {
        const y = pad.top+(cH/4)*i;
        ctx.beginPath(); ctx.moveTo(pad.left,y); ctx.lineTo(pad.left+cW,y); ctx.stroke();
        const v = minV+range*(1-i/4);
        ctx.fillStyle='#94a3b8'; ctx.font='9px JetBrains Mono,monospace'; ctx.textAlign='right';
        ctx.fillText('$'+Math.round(v).toLocaleString(), pad.left-5, y+3);
    }

    ctx.fillStyle='#94a3b8'; ctx.font='9px JetBrains Mono,monospace'; ctx.textAlign='center';
    labels.forEach((l,i) => {
        if (labels.length <= 13 || i % Math.ceil(labels.length/10) === 0 || i===labels.length-1)
            ctx.fillText(l, pts[i].x, H-6);
    });

    const grad = ctx.createLinearGradient(0,pad.top,0,pad.top+cH);
    grad.addColorStop(0,'rgba(102,126,234,0.2)');
    grad.addColorStop(1,'rgba(102,126,234,0.0)');
    ctx.beginPath();
    ctx.moveTo(pts[0].x, pad.top+cH);
    pts.forEach(p => ctx.lineTo(p.x,p.y));
    ctx.lineTo(pts[pts.length-1].x, pad.top+cH);
    ctx.closePath(); ctx.fillStyle=grad; ctx.fill();

    ctx.beginPath();
    pts.forEach((p,i) => i===0 ? ctx.moveTo(p.x,p.y) : ctx.lineTo(p.x,p.y));
    ctx.strokeStyle='#667eea'; ctx.lineWidth=2.5; ctx.lineJoin='round'; ctx.stroke();

    pts.forEach(p => {
        ctx.beginPath(); ctx.arc(p.x,p.y,3.5,0,Math.PI*2);
        ctx.fillStyle='#667eea'; ctx.fill();
        ctx.strokeStyle='white'; ctx.lineWidth=1.5; ctx.stroke();
    });
}

function drawScenarios(invest, months, fee) {
    const aggressiveRate = +(PAMM.monthReturn * 1.15).toFixed(2);
    const scenarios = [
        {
            key: 'bear', label: 'Conservative Scenario', rate: 40,
            how: `40% chosen as ‚Öì of the ${PAMM.monthReturn}% verified monthly average. This models a significantly underperforming period ‚Äî drawdown, ranging market, or reduced signal quality. It is the most pessimistic realistic scenario, not a worst-case.`
        },
        {
            key: 'base', label: 'Base Case Scenario', rate: PAMM.monthReturn,
            how: `${PAMM.monthReturn}% is the direct verified monthly return from XAUUSD performance data: ${PAMM.totalTrades} trades, ${PAMM.tradesWon} wins, $${PAMM.totalProfit.toLocaleString()} profit over ${PAMM.ageDays} days. This is the most grounded projection ‚Äî it assumes performance continues at the documented pace.`
        },
        {
            key: 'bull', label: 'Aggressive Scenario', rate: aggressiveRate,
            how: `${aggressiveRate}% = ${PAMM.monthReturn}% base √ó 115% ‚Äî exactly 15% above the verified monthly average. This models a modestly stronger month with elevated Gold volatility or increased trade frequency. Not an outlier ‚Äî a realistic upside.`
        }
    ];

    const container = document.getElementById('scenarioCards');
    container.innerHTML = '';

    let noteHtml = `<strong>How each scenario rate was derived:</strong><br>`;
    scenarios.forEach(s => {
        let bal = invest, tG=0, tF=0, tN=0;
        for (let m=0; m<months; m++) {
            const g=bal*(s.rate/100), f=g>0?g*(fee/100):0, n=g-f;
            tG+=g; tF+=f; tN+=n; bal+=n;
        }
        const roi = ((bal-invest)/invest*100);
        const monthly = tN/months;
        const daily = monthly/PAMM.tradingDaysPerMonth;

        const div = document.createElement('div');
        div.className = `sc-card ${s.key}`;
        div.innerHTML = `
            <div class="sc-header"><div class="sc-dot"></div><div class="sc-label">${s.label}</div></div>
            <div class="sc-return">${roi>=0?'+':''}${roi.toFixed(0)}%</div>
            <div class="sc-final">${fmt(bal)} projected value</div>
            <div class="sc-detail" style="margin-bottom:0.75rem;">${s.how}</div>
            <div class="sc-divider"></div>
            <div class="sc-stats">
                <div class="sc-stat"><div class="sc-stat-val">${fmt(tN)}</div><div class="sc-stat-lbl">Total Net</div></div>
                <div class="sc-stat"><div class="sc-stat-val">${fmt(monthly)}</div><div class="sc-stat-lbl">Avg/Month</div></div>
                <div class="sc-stat"><div class="sc-stat-val">${fmt(daily,2)}</div><div class="sc-stat-lbl">Avg/Day</div></div>
                <div class="sc-stat"><div class="sc-stat-val">${s.rate}%</div><div class="sc-stat-lbl">Rate Used</div></div>
                <div class="sc-stat"><div class="sc-stat-val">${fmt(tF)}</div><div class="sc-stat-lbl">Fees Paid</div></div>
                <div class="sc-stat"><div class="sc-stat-val">${fmt(tN/invest*100,1)}%</div><div class="sc-stat-lbl">Net ROI</div></div>
            </div>
        `;
        container.appendChild(div);

        noteHtml += `<br><strong>${s.label} (${s.rate}%/mo):</strong> ${s.how}`;
    });

    noteHtml += `<br><br>All three scenarios use <strong>${fee}% performance fee</strong> on profits only, with full compounding over <strong>${months} month${months!==1?'s':''}.</strong> The ${PAMM.monthReturn}% base is sourced directly from verified XAUUSD data ‚Äî ${PAMM.totalTrades} trades, ${PAMM.tradesWon} wins, ${PAMM.winRate}% accuracy.`;
    document.getElementById('scenarioNote').innerHTML = noteHtml;
}

calc();
window.addEventListener('resize', calc);

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  INVESTMENT TRACKER ‚Äî derives return from actual amount
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const PAMM_REF_RATE = 119.23;
let tradeCounter = 0;

(function initDates() {
    const t = new Date();
    document.getElementById('trFrom').value = t.toISOString().split('T')[0];
    const e = new Date(t); e.setMonth(e.getMonth() + 3);
    document.getElementById('trTo').value = e.toISOString().split('T')[0];
    runTracker();
})();

function td(n,dec=2){ return '$'+Math.abs(n).toLocaleString('en-US',{minimumFractionDigits:dec,maximumFractionDigits:dec}); }
function ts(n,dec=2){ return (n>=0?'+':'-')+td(n,dec); }
function tp(n,dec=2){ return (n>=0?'+':'')+n.toFixed(dec)+'%'; }
function fd(d){ return d.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric',year:'numeric'}); }
function rel(d){
    const now=new Date();now.setHours(0,0,0,0);
    const diff=Math.round((d-now)/86400000);
    if(diff===0)return 'üìç Today';
    if(diff===1)return 'Tomorrow';
    if(diff===-1)return 'Yesterday';
    if(diff<0)return Math.abs(diff)+' days ago';
    if(diff<8)return 'In '+diff+' day'+(diff>1?'s':'');
    if(diff<60)return 'In ~'+Math.round(diff/7)+' wk'+(Math.round(diff/7)>1?'s':'');
    if(diff<365)return 'In ~'+Math.round(diff/30.5)+' mo';
    return 'In ~'+(diff/365).toFixed(1)+' yrs';
}
function addMo(d,n){ const x=new Date(d);x.setMonth(x.getMonth()+n);return x; }
function mosBetween(a,b){ return Math.max(1,(b.getFullYear()-a.getFullYear())*12+b.getMonth()-a.getMonth()); }

function pammProject(invest,months,fee){
    let b=invest;
    for(let i=0;i<months;i++){const g=b*(PAMM_REF_RATE/100);b+=g>0?g*(1-fee/100):g;}
    return b;
}

function cRow(icon,label,val,color,sub='',big=false){
    return `<div style="display:flex;align-items:center;justify-content:space-between;padding:0.75rem 1rem;border-radius:10px;border:1.5px solid ${color}25;background:${color}07;gap:1rem;flex-wrap:wrap;margin-bottom:0.5rem;">
      <div>
        <div style="font-size:0.8125rem;font-weight:600;color:var(--text-secondary);">${icon} ${label}</div>
        ${sub?`<div style="font-size:0.65rem;color:var(--text-tertiary);margin-top:0.15rem;">${sub}</div>`:''}
      </div>
      <div style="font-family:'JetBrains Mono',monospace;font-size:${big?'1.375':'1.0625'}rem;font-weight:800;color:${color};white-space:nowrap;">${val}</div>
    </div>`;
}

function runTracker(){
    const invest  = parseFloat(document.getElementById('trInvest').value)||0;
    const fromVal = document.getElementById('trFrom').value;
    const toVal   = document.getElementById('trTo').value;
    const fee     = parseFloat(document.getElementById('trFee').value)||0;
    const actualRaw = document.getElementById('trActual').value;
    const actual  = actualRaw!==''?parseFloat(actualRaw):null;

    if(!invest||!fromVal||!toVal){document.getElementById('trackerResults').style.display='none';return;}
    const fromDate=new Date(fromVal+'T00:00:00');
    const toDate=new Date(toVal+'T00:00:00');
    if(toDate<=fromDate)return;

    const months   =mosBetween(fromDate,toDate);
    const calDays  =Math.round((toDate-fromDate)/86400000);
    const tradeDays=Math.round(calDays*5/7);

    const pSum=document.getElementById('trPeriodSummary');
    pSum.style.display='block';
    pSum.innerHTML=`üìÖ <strong>${fd(fromDate)}</strong> ‚Üí <strong>${fd(toDate)}</strong> &nbsp;¬∑&nbsp; <strong>${months}</strong> month${months!==1?'s':''} &nbsp;¬∑&nbsp; <strong>${calDays}</strong> calendar days &nbsp;¬∑&nbsp; ~<strong>${tradeDays}</strong> trading days`;
    document.getElementById('trPeriodBadge').textContent=`${months} mo ¬∑ ${calDays} days`;
    document.getElementById('trackerResults').style.display='block';

    const projEnd   =pammProject(invest,months,fee);
    const projProfit=projEnd-invest;
    const projROI   =(projProfit/invest)*100;
    const projMo    =projProfit/months;
    const projDay   =projProfit/tradeDays;

    // Milestones
    const msList=[{label:'1 Month',mo:1},{label:'2 Months',mo:2},{label:'3 Months',mo:3},
        {label:'6 Months',mo:6},{label:'9 Months',mo:9},{label:'1 Year',mo:12},
        {label:'18 Months',mo:18},{label:'2 Years',mo:24}];
    const today=new Date();today.setHours(0,0,0,0);
    let mHtml='';
    msList.forEach(ms=>{
        const mDate=addMo(fromDate,ms.mo);
        const bal=pammProject(invest,ms.mo,fee);
        const profit=bal-invest;
        const isPast=mDate<today,isNow=mDate.toDateString()===today.toDateString(),inRng=mDate<=toDate;
        const cls=isPast?'past':isNow?'today':inRng?'soon':'future';
        const badge=isPast?'<span class="ms-badge past">Past</span>':isNow?'<span class="ms-badge now">TODAY</span>':'<span class="ms-badge coming">Upcoming</span>';
        const warn=!inRng?'<div style="font-size:0.55rem;color:var(--warning);margin-top:0.15rem">‚ö† Beyond end date</div>':'';
        mHtml+=`<div class="milestone-card ${cls}">
            <div class="ms-period">${ms.label}</div>
            <div class="ms-date">${fd(mDate)}</div>
            <div class="ms-rel">${rel(mDate)}</div>
            <div class="ms-val">${td(bal)}</div>
            <div class="ms-profit">+${td(profit)} profit</div>
            ${badge}${warn}
        </div>`;
    });
    document.getElementById('trMilestones').innerHTML=mHtml;

    const bdEl=document.getElementById('trActualBreakdown');
    const vBadge=document.getElementById('trVerdictBadge');

    if(actual!==null&&!isNaN(actual)&&actual>0){
        const profit=actual-invest;
        const roi=(profit/invest)*100;
        const mo=profit/months;
        const day=profit/tradeDays;
        const week=day*5;
        const beat=actual>=projEnd;
        const diff=actual-projEnd;
        const pColor=profit>=0?'var(--success)':'var(--danger)';
        const vColor=beat?'var(--success)':'var(--danger)';
        const impliedMoRate=(Math.pow(actual/invest,1/months)-1)*100;
        const rateVsRef=impliedMoRate-PAMM_REF_RATE;

        vBadge.style.display='inline-block';
        vBadge.textContent=beat?'üü¢ BEAT PAMM':'üî¥ BELOW PAMM';
        vBadge.style.background=beat?'rgba(16,185,129,0.1)':'rgba(239,68,68,0.08)';
        vBadge.style.color=vColor;
        vBadge.style.borderColor=beat?'rgba(16,185,129,0.3)':'rgba(239,68,68,0.25)';

        bdEl.innerHTML=`
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:0.625rem;padding:1.25rem 1.5rem 1rem;">
            <div style="background:var(--bg-secondary);border:1.5px solid var(--border);border-radius:12px;padding:0.875rem;text-align:center;">
              <div style="font-size:0.55rem;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-secondary);margin-bottom:0.3rem;">You Got Back</div>
              <div style="font-family:'JetBrains Mono',monospace;font-size:1.25rem;font-weight:800;color:var(--text-primary);line-height:1;">${td(actual)}</div>
              <div style="font-size:0.6rem;color:var(--text-tertiary);margin-top:0.2rem;">from ${td(invest)}</div>
            </div>
            <div style="background:var(--bg-secondary);border:1.5px solid var(--border);border-radius:12px;padding:0.875rem;text-align:center;">
              <div style="font-size:0.55rem;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-secondary);margin-bottom:0.3rem;">Net Profit</div>
              <div style="font-family:'JetBrains Mono',monospace;font-size:1.25rem;font-weight:800;color:${pColor};line-height:1;">${ts(profit)}</div>
              <div style="font-size:0.6rem;color:var(--text-tertiary);margin-top:0.2rem;">${months} month${months!==1?'s':''}</div>
            </div>
            <div style="background:var(--bg-secondary);border:1.5px solid var(--border);border-radius:12px;padding:0.875rem;text-align:center;">
              <div style="font-size:0.55rem;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-secondary);margin-bottom:0.3rem;">Total ROI</div>
              <div style="font-family:'JetBrains Mono',monospace;font-size:1.25rem;font-weight:800;color:${pColor};line-height:1;">${tp(roi)}</div>
              <div style="font-size:0.6rem;color:var(--text-tertiary);margin-top:0.2rem;">${calDays} days</div>
            </div>
          </div>
          <div style="padding:0 1.5rem 1.5rem;display:flex;flex-direction:column;gap:0.5rem;">
            ${cRow('üìà','Your Monthly Return Rate',tp(impliedMoRate),pColor,`Calculated from results ¬∑ PAMM ref: ${PAMM_REF_RATE}% ¬∑ Your rate vs ref: ${tp(rateVsRef)}`)}
            ${cRow('üìÖ','Avg Monthly Profit',ts(mo),pColor,`Over ${months} months`)}
            ${cRow('üìÖ','Avg Daily Profit',ts(day),pColor,`~${tradeDays} trading days`)}
            ${cRow('üìÖ','Avg Weekly Profit',ts(week),pColor,`~${Math.round(tradeDays/5)} weeks`)}
            <div style="height:1px;background:var(--border);margin:0.25rem 0;"></div>
            ${cRow('üéØ','PAMM Projection Same Period',td(projEnd),'var(--accent)',`${PAMM_REF_RATE}%/mo ref ¬∑ ${tp(projROI)} ROI ¬∑ avg ${ts(projMo)}/mo`)}
            <div style="display:flex;align-items:center;justify-content:space-between;padding:1rem 1.125rem;border-radius:12px;border:2px solid ${vColor}40;background:${vColor}08;flex-wrap:wrap;gap:0.75rem;margin-top:0.25rem;">
              <div>
                <div style="font-size:0.9375rem;font-weight:800;color:${vColor};">${beat?'üü¢ You beat the PAMM projection':'üî¥ You came in below the PAMM projection'}</div>
                <div style="font-size:0.7rem;color:var(--text-secondary);margin-top:0.25rem;">Your ROI: ${tp(roi)} &nbsp;|&nbsp; PAMM projected: ${tp(projROI)} &nbsp;|&nbsp; Gap: ${tp(roi-projROI)} pts</div>
              </div>
              <div style="font-family:'JetBrains Mono',monospace;font-size:1.625rem;font-weight:800;color:${vColor};">${ts(diff)}</div>
            </div>
          </div>`;

        document.getElementById('trCompareBody').innerHTML=`
            ${cRow('üí∞','You Invested',td(invest),'var(--text-secondary)')}
            ${cRow('‚úÖ','You Got Back (Actual)',td(actual),pColor)}
            ${cRow('üìà','Your Net Profit',ts(profit),pColor)}
            ${cRow('üìä','Your Total ROI',tp(roi),pColor,`${months} months ¬∑ ${calDays} days`)}
            ${cRow('üìà','Your Monthly Return Rate',tp(impliedMoRate),pColor,'Back-calculated from your actual result')}
            ${cRow('üìÖ','Avg / Month',ts(mo),pColor)}
            ${cRow('üìÖ','Avg / Day',ts(day),pColor,`~${tradeDays} trading days`)}
            <div style="height:1px;background:var(--border);margin:0.75rem 0;"></div>
            ${cRow('üéØ','PAMM Projected End Value',td(projEnd),'var(--accent)',`At ${PAMM_REF_RATE}%/mo ref rate`)}
            ${cRow('üéØ','PAMM Projected Profit',ts(projProfit),'var(--accent)',tp(projROI)+' ROI')}
            ${cRow('üéØ','PAMM Avg / Month',ts(projMo),'var(--accent)')}
            <div style="height:1px;background:var(--border);margin:0.75rem 0;"></div>
            <div style="display:flex;align-items:center;justify-content:space-between;padding:1rem;border-radius:10px;border:2px solid ${vColor}40;background:${vColor}08;flex-wrap:wrap;gap:0.5rem;">
              <span style="font-weight:700;color:${vColor};font-size:0.9375rem;">${beat?'üü¢ Outperformed PAMM by':'üî¥ Underperformed PAMM by'}</span>
              <span style="font-family:'JetBrains Mono',monospace;font-weight:800;font-size:1.25rem;color:${vColor};">${ts(diff)} &nbsp;(${tp(roi-projROI,1)} pts)</span>
            </div>`;

    } else {
        vBadge.style.display='none';
        bdEl.innerHTML=`
          <div style="padding:1.25rem 1.5rem;">
            <div style="background:rgba(217,119,6,0.07);border:1px solid rgba(217,119,6,0.2);border-radius:10px;padding:0.75rem 1rem;font-size:0.8rem;color:var(--gold);margin-bottom:1rem;">
              üìä Showing PAMM projection for your period. Enter what you <strong>actually received</strong> to the left to get your real return breakdown.
            </div>
            ${cRow('üí∞','Investment',td(invest),'var(--text-secondary)')}
            ${cRow('üéØ','PAMM Projected End Value',td(projEnd),'var(--accent)',`${months} months at ${PAMM_REF_RATE}%/mo ref rate`,true)}
            ${cRow('üìà','PAMM Projected Profit',ts(projProfit),'var(--accent)',tp(projROI)+' total ROI')}
            ${cRow('üìÖ','PAMM Avg / Month',ts(projMo),'var(--accent)')}
            ${cRow('üìÖ','PAMM Avg / Day',ts(projDay),'var(--accent)',`~${tradeDays} trading days`)}
          </div>`;
        document.getElementById('trCompareBody').innerHTML=`<div style="font-size:0.8125rem;color:var(--text-secondary);font-style:italic;">Enter your actual received amount in the form to see the full comparison.</div>`;
    }
    renderTradeLog();
}

function addTrade(){
    const id=++tradeCounter;
    const today=new Date().toISOString().split('T')[0];
    document.getElementById('trNoTrades')?.remove();
    const tr=document.createElement('tr');
    tr.id='tr-row-'+id;
    tr.innerHTML=`
        <td><input type="date" value="${today}" style="min-width:120px"></td>
        <td><select style="min-width:85px"><option value="win">‚úÖ Win</option><option value="loss">‚ùå Loss</option><option value="be">‚û°Ô∏è B/E</option></select></td>
        <td><input type="number" id="tr-gross-${id}" placeholder="0.00" step="0.01" oninput="calcRow(${id})" style="width:90px"></td>
        <td id="tr-fee-${id}" style="font-family:'JetBrains Mono',monospace;font-size:0.8rem;font-weight:700;color:var(--danger)">‚Äî</td>
        <td id="tr-net-${id}" style="font-family:'JetBrains Mono',monospace;font-size:0.8rem;font-weight:700;">‚Äî</td>
        <td><input type="text" placeholder="Notes..." style="min-width:90px"></td>
        <td><button class="del-btn" onclick="deleteTrade(${id})">‚úï</button></td>`;
    document.getElementById('tradeBody').appendChild(tr);
}

function calcRow(id){
    const gross=parseFloat(document.getElementById('tr-gross-'+id)?.value)||0;
    const fee=parseFloat(document.getElementById('trFee').value)||0;
    const fa=gross>0?gross*(fee/100):0,net=gross-fa;
    const fEl=document.getElementById('tr-fee-'+id),nEl=document.getElementById('tr-net-'+id);
    if(fEl)fEl.textContent=fa>0?'-'+td(fa):'‚Äî';
    if(nEl){nEl.textContent=gross!==0?ts(net):'‚Äî';nEl.style.color=net>=0?'var(--success)':'var(--danger)';}
    renderTradeLog();
}

function deleteTrade(id){
    document.getElementById('tr-row-'+id)?.remove();
    if(!document.querySelectorAll('#tradeBody tr:not(#trNoTrades)').length)
        document.getElementById('tradeBody').innerHTML='<tr id="trNoTrades"><td colspan="7" style="text-align:center;color:var(--text-tertiary);font-size:0.75rem;padding:1.5rem 1rem">No trades logged yet.</td></tr>';
    renderTradeLog();
}

function renderTradeLog(){
    const fee=parseFloat(document.getElementById('trFee').value)||0;
    const rows=document.querySelectorAll('#tradeBody tr:not(#trNoTrades)');
    let g=0,f=0,n=0,w=0,l=0;
    rows.forEach(r=>{
        const gross=parseFloat(r.querySelector('input[type="number"]')?.value)||0;
        const fa=gross>0?gross*(fee/100):0;
        g+=gross;f+=fa;n+=(gross-fa);
        const v=r.querySelector('select')?.value;
        if(v==='win')w++;if(v==='loss')l++;
    });
    const s=document.getElementById('trLogSummary');
    if(rows.length>0){
        s.style.display='flex';
        s.innerHTML=`
            <div class="log-sum-item"><div class="log-sum-val">${rows.length}</div><div class="log-sum-lbl">Trades</div></div>
            <div class="log-sum-item"><div class="log-sum-val" style="color:var(--success)">${w}</div><div class="log-sum-lbl">Wins</div></div>
            <div class="log-sum-item"><div class="log-sum-val" style="color:var(--danger)">${l}</div><div class="log-sum-lbl">Losses</div></div>
            <div class="log-sum-item"><div class="log-sum-val" style="color:var(--accent)">${rows.length?Math.round(w/rows.length*100):0}%</div><div class="log-sum-lbl">Win Rate</div></div>
            <div class="log-sum-item"><div class="log-sum-val" style="color:${g>=0?'var(--success)':'var(--danger)'}">${ts(g)}</div><div class="log-sum-lbl">Gross</div></div>
            <div class="log-sum-item"><div class="log-sum-val" style="color:var(--danger)">-${td(f)}</div><div class="log-sum-lbl">Fees</div></div>
            <div class="log-sum-item"><div class="log-sum-val" style="color:${n>=0?'var(--success)':'var(--danger)'}">${ts(n)}</div><div class="log-sum-lbl">Net P&L</div></div>`;
    } else s.style.display='none';
}

</script>
</body>
</html>
